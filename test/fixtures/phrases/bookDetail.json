{
  "url": "book/:id?",
  "get": {
    "codehash": "aWYgKCFyZXEuZ2V0KCJBdXRob3JpemF0aW9uIikpIHsKICByZXMuc3RhdHVzKDQwMSkuc2VuZChuZXcgQ29tcG9zZXJFcnJvcigiZXJyb3I6YXV0aG9yaXphdGlvbjp1bmRlZmluZWQiLCAiIiwgNDAxKSk7CiAgcmV0dXJuCn0KCmlmKCFyZXEucGFyYW1zLmlkKXsKICAgIHJlcy5zZW5kKHsKICAgICAgIHN0YXR1czogNDAwLAogICAgICAgZGVzY3JpcHRpb246ICdQYXJhbWV0ZXJzIGFyZSBpbnZhbGlkcycKICB9KTsKfQoKLy9HZXQgdGhlIGJvb2tzIHdpdGggdGhlIGNhdGVnb3JpZXMKZnVuY3Rpb24gbG9hZEJvb2tEZXRhaWwocGFyYW1zKSB7CiAgdmFyIGRmZCA9IHEuZGVmZXIoKTsKICBnZXRCb29rQXNzZXQocGFyYW1zLmlkKQogICAgLnRoZW4oZnVuY3Rpb24oYXNzZXQpIHsKICAgICAgcmV0dXJuIGxvYWRCb29rKHBhcmFtcy5pZCwgYXNzZXQpOwogICAgfSkKICAgIC50aGVuKGRmZC5yZXNvbHZlKQogICAgLmNhdGNoKGRmZC5yZWplY3QpOwoKICByZXR1cm4gZGZkLnByb21pc2U7Cn0KCgovKioKICogUmVjdXJzaXZlbGx5IGZldGNoIGFsbCB0aGUgaXRlbXMgZm9yIGEgbGlzdAogKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGVyICAgICBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBwcm9taXNlIHdpdGggZmV0Y2hlZCBpdGVtcwogKiBAcGFyYW0gIHtMaXN0fSBpdGVtcyAgICAgIExpc3Qgb2YgaXRlbXMKICogQHBhcmFtICB7SW50ZWdlcn0gcGFnZU51bWJlcgogKiBAcGFyYW0gIHtJbnRlZ2VyfSBwYWdlU2l6ZQogKiBAcGFyYW0gIHtwcm9taXNlfSBwcm9taXNlCiAqIEByZXR1cm4ge0xpc3R9CiAqLwp2YXIgZ2V0QWxsUmVjdXJzaXZlbHkgPSBmdW5jdGlvbihjYWxsZXIsIGl0ZW1zLCBwYWdlTnVtYmVyLCBwYWdlU2l6ZSwgcHJvbWlzZSkgewogIGl0ZW1zID0gaXRlbXMgfHwgW107CiAgcGFnZU51bWJlciA9IHBhZ2VOdW1iZXIgfHwgMDsKICBwYWdlU2l6ZSA9IHBhZ2VTaXplIHx8IDIwOwogIHByb21pc2UgPSBwcm9taXNlIHx8IHEucmVzb2x2ZSgpOwoKICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKCkgewoKICAgIHJldHVybiBjYWxsZXIocGFnZU51bWJlciwgcGFnZVNpemUpLgogICAgdGhlbihmdW5jdGlvbihyZXNwb25zZSkgewogICAgICBpZiAocmVzcG9uc2UuZGF0YSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgIGl0ZW1zID0gaXRlbXMuY29uY2F0KHJlc3BvbnNlLmRhdGEpOwogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmxlbmd0aCA8IHBhZ2VTaXplKSB7CiAgICAgICAgICByZXR1cm4gaXRlbXM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBnZXRBbGxSZWN1cnNpdmVseShjYWxsZXIsIGl0ZW1zLCBwYWdlTnVtYmVyICsgMSwgcGFnZVNpemUsIHByb21pc2UpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgQ29tcG9zZXJFcnJvcignZXJyb3I6Z2V0OmJvb2tzJywgJycsIDUwMCk7CiAgICAgIH0KICAgIH0pOwogIH0pOwp9OwoKLyoqCiAqIFJldHVybiBhbiBhc3NldCAoaWYgZXhpc3RzKSBmb3IgdGhlIGJvb2sKICovCmZ1bmN0aW9uIGdldEJvb2tBc3NldChib29rSWQpIHsKICB2YXIgZGZkID0gcS5kZWZlcigpOwoKICBjb3JiZWxEcml2ZXIuYXNzZXRzKCkuZ2V0KHsKICAgIHF1ZXJ5OiBbewogICAgICAnJGVxJzogewogICAgICAgICduYW1lJzogJ0Jvb2sgdmlld3MnCiAgICAgIH0sCiAgICAgICckZXEnOiB7CiAgICAgICAgJ3Byb2R1Y3RJZCc6IGJvb2tJZAogICAgICB9CiAgICB9XQogIH0pCiAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkgewogICAgICBkZmQucmVzb2x2ZShyZXNwb25zZS5kYXRhKTsKICAgIH0pCiAgICAuY2F0Y2goZGZkLnJlamVjdCkKCiAgcmV0dXJuIGRmZC5wcm9taXNlOwp9CgoKLyoqCiAqIExvYWQgYSBib29rIGFuZCBhc3NvY2lhdGUgdGhlIGNhdGVnb3JpZXMgdG8gaXQKICovCmZ1bmN0aW9uIGxvYWRCb29rKGJvb2tJZCwgYXNzZXRzKSB7CiAgdmFyIGRmZCA9IHEuZGVmZXIoKTsKCiAgdmFyIGJvb2s7CgogIHZhciBhc3NldHNJZHMgPSBhc3NldHMubWFwKGZ1bmN0aW9uKGFzc2V0KSB7CiAgICByZXR1cm4gJ2Jvb2tzOkJvb2svJyArIGFzc2V0LnByb2R1Y3RJZDsKICB9KTsKCgogIGNvcmJlbERyaXZlci5yZXNvdXJjZXMucmVsYXRpb24oJ2Jvb2tzOlN0b3JlJywgJ2Jvb3FzOmRlbW8nLCAnYm9va3M6Qm9vaycpCiAgICAuZ2V0KGJvb2tJZCkKICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgIGJvb2sgPSBuZXcgQm9va01vZGVsKHJlc3BvbnNlLmRhdGEsIGFzc2V0c0lkcyk7CiAgICAgIHJldHVybiBmZXRjaENhdGVnb3JpZXMoYm9vay50b3BpY3MpOwogICAgfSkKICAgIC50aGVuKGZ1bmN0aW9uKGNhdGVnb3JpZXMpIHsKICAgICAgYm9vay50b3BpY3MgPSBib29rLnRvcGljcy5tYXAoZnVuY3Rpb24odG9waWNJZCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpZDogdG9waWNJZCwKICAgICAgICAgIG5hbWU6IGNhdGVnb3JpZXNbdG9waWNJZF0ubmFtZQogICAgICAgIH0KICAgICAgfSk7CgogICAgICBkZmQucmVzb2x2ZShib29rKTsKICAgIH0pCiAgICAuY2F0Y2goZGZkLnJlamVjdCk7CgogIHJldHVybiBkZmQucHJvbWlzZTsKfQoKLyoqCiAqIEZldGNoZXMgYWxsIHRoZSBjYXRlZ29yaWVzIGFzc29jaWF0ZWQgdG8gYSBsaXN0IG9mIGNhdGVnb3JpZXMgaWRzCiAqLwpmdW5jdGlvbiBmZXRjaENhdGVnb3JpZXMoaWRzKSB7CiAgdmFyIGRmZCA9IHEuZGVmZXIoKTsKCiAgdmFyIGNhbGxlciA9IGZ1bmN0aW9uKHBhZ2VOdW1iZXIsIHBhZ2VTaXplKSB7CiAgICByZXR1cm4gY29yYmVsRHJpdmVyLnJlc291cmNlcwogICAgICAuY29sbGVjdGlvbignYm9va3M6Q2F0ZWdvcnknKQogICAgICAuZ2V0KHsKICAgICAgICBwYWdpbmF0aW9uOiB7CiAgICAgICAgICBwYWdlOiBwYWdlTnVtYmVyLAogICAgICAgICAgc2l6ZTogcGFnZVNpemUKICAgICAgICB9LAogICAgICAgIHF1ZXJ5OiBbewogICAgICAgICAgJyRpbic6IHsKICAgICAgICAgICAgJ2lkJzogaWRzCiAgICAgICAgICB9CiAgICAgICAgfV0KICAgICAgfSk7CiAgfQoKICBnZXRBbGxSZWN1cnNpdmVseShjYWxsZXIpCiAgICAudGhlbihmdW5jdGlvbihjYXRlZ29yaWVzKSB7CiAgICAgIHZhciByZXN1bHQgPSB7fTsKICAgICAgY2F0ZWdvcmllcy5mb3JFYWNoKGZ1bmN0aW9uKGNhdGVnb3J5KSB7CiAgICAgICAgcmVzdWx0W2NhdGVnb3J5LmlkXSA9IGNhdGVnb3J5OwogICAgICB9KTsKCiAgICAgIGRmZC5yZXNvbHZlKHJlc3VsdCk7CiAgICB9KQogICAgLmNhdGNoKGRmZC5yZWplY3QpOwogIHJldHVybiBkZmQucHJvbWlzZTsKfQoKCnZhciBCb29rTW9kZWwgPSBmdW5jdGlvbihvcHRzLCBhc3NldHNJZHMpIHsKICB0aGlzLmlkID0gb3B0cy5pZC5yZXBsYWNlKCdib29rczpCb29rLycsICcnKTsKCiAgLy90aXRsZXRleHQKICB0aGlzLnRpdGxlVGV4dCA9IG9wdHMudGl0bGU7CgogIC8vcHVibGlzaGVyTmFtZQogIHRoaXMucHVibGlzaGVyTmFtZSA9IG9wdHMucHVibGlzaGVyR3JvdXBOYW1lOwoKICAvL2xhbmd1YWdlcwogIHRoaXMubGFuZ3VhZ2VzID0gW29wdHMubGFuZ3VhZ2VdOwoKICAvL3B1YmxpY2F0aW9uRGF0ZQogIHRoaXMucHVibGljYXRpb25EYXRlID0gb3B0cy5wdWJsaXNoaW5nVGltZSA/IChuZXcgRGF0ZShvcHRzLnB1Ymxpc2hpbmdUaW1lKSkudG9JU09TdHJpbmcoKSA6IG51bGw7CgogIC8vTnVtYmVyIG9mIHBhZ2VzIFRPRE8KICB0aGlzLm51bWJlck9mUGFnZXMgPSAwOwoKICAvL2F1dGhvcnMKICB0aGlzLmF1dGhvcnMgPSBvcHRzLmF1dGhvcnMubWFwKGZ1bmN0aW9uKGF1dGhvcikgewogICAgcmV0dXJuIGF1dGhvci5uYW1lOwogIH0pOwoKICAvL1RvcGljcyAKICB0aGlzLnRvcGljcyA9IG9wdHMuc3RvcmVDYXRlZ29yaWVzID8gb3B0cy5zdG9yZUNhdGVnb3JpZXMgOiBbXTsKCgogIC8vcHJvZHVjdElkZW50aWZpZXIKICB0aGlzLnByb2R1Y3RJZGVudGlmaWVyID0gW3sKICAgICJQcm9kdWN0SURUeXBlIjogIklTQk4iLAogICAgIklEVmFsdWUiOiBvcHRzLmlzYm4KICB9XTsKCiAgLy9Qcm9kdWN0IGZvcm0gZGV0YWlsCiAgdGhpcy5wcm9kdWN0Rm9ybURldGFpbCA9IFtvcHRzLmZvcm1hdF07CgoKICAvL2VwdWJUZWNobmljYWxQcm90ZWN0aW9uIFRPRE8KICB0aGlzLmVwdWJUZWNobmljYWxQcm90ZWN0aW9uID0gbnVsbDsKCiAgLy9wcm9kdWN0U2l6ZQogIHRoaXMucHJvZHVjdFNpemUgPSBvcHRzLnNpemU7CgogIC8vY292ZXJJbWFnZVVybAogIHRoaXMuY292ZXJJbWFnZVVybCA9ICdodHRwczovL3Jlc291cmNlcy1xYS5icXdzLmlvL3YxLjAvcmVzb3VyY2UvYm9va3M6Qm9vay8nICsgb3B0cy5pZDsKCiAgLy9kb3dubG9hZFVybAogIHRoaXMuZG93bmxvYWRVcmwgPSAnaHR0cHM6Ly9yZXNvdXJjZXMtcWEuYnF3cy5pby92MS4wL3Jlc291cmNlL2Jvb2tzOkJvb2svJyArIG9wdHMuaWQ7CgogIC8vZGVzY3JpcHRpb25UZXh0CiAgdGhpcy5kZXNjcmlwdGlvblRleHQgPSBvcHRzLnN5bm9wc2lzOwoKICAvL093bmVkIGJ5IHRoZSB1c2VyCiAgdGhpcy5vd25lZCA9IGFzc2V0c0lkcy5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgbmV4dCkgewogICAgcmV0dXJuIHByZXYgfHwgbmV4dCA9PT0gb3B0cy5pZDsKICB9LCBmYWxzZSk7Cgp9CgovKioKICogVHJpZ2dlcnMgdGhlIGV4ZWN1dGlvbgogKi8KbG9hZEJvb2tEZXRhaWwoewogIGlkIDogcmVxLnBhcmFtcy5pZAp9KQogIC50aGVuKGZ1bmN0aW9uKGJvb2spIHsKICAgIHJlcy5zZW5kKGJvb2spOwogIH0pCiAgLmNhdGNoKGZ1bmN0aW9uKGVycikgewogICAgY29tcG9TUi5ydW4oJ2dsb2JhbDpwYXJzZUVycm9yJywgewogICAgICBlcnI6IGVyciwKICAgICAgcmVzOiByZXMKICAgIH0pOwogIH0pOw==",
    "doc": {
      "parameters": {
        "id" : {
          "type": "String",
          "description": "Book id"
        }
      },
      "description": "Returns the detail of one book",
      "responses": {
        "200": {
          "body": {
            "application/json": {
              "schema": "{\n\t\"$schema\": \"http://json-schema.org/schema\",\n\t\"type\": \"object\",\n\t\"description\": \"Book model\",\n\t\"properties\": {\n\t\t\"id\": {\n\t\t\t\"type\": \"String\",\n\t\t\t\"description\": \"Book id\"\n\t\t},\n\t\t\"titleText\": {\n\t\t\t\"type\": \"String\",\n\t\t\t\"description\": \"Book title\"\n\t\t},\n\t\t\"publisherName\": {\n\t\t\t\"type\": \"String\",\n\t\t\t\"description\": \"Publisher name\"\n\t\t},\n\t\t\"publicationDate\": {\n\t\t\t\"type\": \"String\",\n\t\t\t\"description\": \"ISO Date string\"\n\t\t},\n\t\t\"numberOfPages\": {\n\t\t\t\"type\": \"Number\",\n\t\t\t\"description\": \"Number of pages\"\n\t\t},\n\t\t\"authors\": {\n\t\t\t\"type\": \"Array\",\n\t\t\t\"description\": \"list of user names (strings)\"\n\t\t},\n\t\t\"topics\": {\n\t\t\t\"type\": \"Array\",\n\t\t\t\"description\": \"List of categories\",\n\t\t\t\"id\": {\n\t\t\t\t\"type\": \"String\",\n\t\t\t\t\"description\": \"Category id\"\n\t\t\t},\n\t\t\t\"name\": {\n\t\t\t\t\"type\": \"String\",\n\t\t\t\t\"description\": \"Category name\"\n\t\t\t}\n\t\t},\n\t\t\"languages\": {\n\t\t\t\"type\": \"Array\",\n\t\t\t\"description\": \"List of strings identifying languages\"\n\t\t},\n\t\t\"productIdentifier\": {\n\t\t\t\"type\": \"Array\",\n\t\t\t\"description\": \"List of product identifiers\",\n\t\t\t\"ProductIDType\": {\n\t\t\t\t\"type\": \"String\",\n\t\t\t\t\"description\": \"Type of ID\"\n\t\t\t},\n\t\t\t\"IDValue\": {\n\t\t\t\t\"type\": \"String\",\n\t\t\t\t\"description\": \"ID value\"\n\t\t\t}\n\t\t},\n\t\t\"productFormDetail\": {\n\t\t\t\"type\": \"Array\",\n\t\t\t\"description\": \"List of product types\"\n\t\t},\n\t\t\"epubTechnicalProtection\": {\n\t\t\t\"type\": \"Array\",\n\t\t\t\"description\": \"List of strings identifying technical protections\"\n\t\t},\n\t\t\"productSize\": {\n\t\t\t\"type\": \"Number\",\n\t\t\t\"description\": \"Product size\"\n\t\t},\n\t\t\"coverImageUrl\": {\n\t\t\t\"type\": \"String\"\n\t\t},\n\t\t\"downloadUrl\": {\n\t\t\t\"type\": \"String\"\n\t\t},\n\t\t\"descriptionText\": {\n\t\t\t\"type\": \"String\"\n\t\t},\n\t\t\"owned\": {\n\t\t\t\"type\": \"Boolean\"\n\t\t}\n\t},\n\t\"required\": [\"id\", \"titleText\", \"publisherName\", \"publicationDate\", \"numberOfPages\", \"authors\", \"topics\", \"languages\", \"productIdentifier\", \"productFormDetail\", \"epubTechnicalProtection\", \"productSize\", \"coverImageUrl\", \"downloadUrl\", \"descriptionText\", \"owned\"]\n}",
              "example": "{\n\t\t\"id\": \"e158d30801e729a4a970d19ba8c3ff7d\",\n\t\t\"titleText\": \"A tres metros sobre el cielo\",\n\t\t\"publisherName\": \"Grupo Planeta\",\n\t\t\"publicationDate\": \"20100712\",\n\t\t\"numberOfPages\": \"\",\n\t\t\"authors\": [\n\t\t\t\t\"Federico Moccia\"\n\t\t],\n\t\t\"topics\": [\n\t\t\t\t{\n\t\t\t\t\t\t\"id\": \"YF\",\n\t\t\t\t\t\t\"name\": \"Juvenil\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\t\"id\": \"JHB\",\n\t\t\t\t\t\t\"name\": \"Sociología\"\n\t\t\t\t}\n\t\t],\n\t\t\"languages\": [\n\t\t\t\t\"spa\"\n\t\t],\n\t\t\"productIdentifier\": [\n\t\t\t\t{\n\t\t\t\t\t\t\"ProductIDType\": \"ISBN\",\n\t\t\t\t\t\t\"IDValue\": \"9788408095538\"\n\t\t\t\t}\n\t\t],\n\t\t\"productFormDetail\": [\n\t\t\t\t\"EPUB\",\n\t\t\t\t\"reflowable\"\n\t\t],\n\t\t\"epubTechnicalProtection\": [\n\t\t\t\t\"Adobe DRM\"\n\t\t],\n\t\t\"productSize\": \"\",\n\t\t\"coverImageUrl\": \"\",\n\t\t\"downloadUrl\": \"\",\n\t\t\"descriptionText\": \"Babi es una estudiante modelo y la hija perfecta. Step, en cambio, es violento y descarado. Provienen de dos mundos completamente distintos. A pesar de todo, entre los dos nacerá un amor más allá de todas las convenciones. Un amor controvertido por el que deberán luchar más de lo que esperaban. Babi y Step se erigen como un Romeo y Julieta contemporáneos en Roma, un escenario que parece creado para el amor\",\n\t\t\"owned\": \"true\"\n}"
            }
          }
        },
        "400": {
          "description": "Bad Request, missing id",
          "body": {
            "application/json": {
              "schema": "{\n\t\"$schema\": \"http://json-schema.org/schema\",\n\t\"type\": \"object\",\n\t\"description\": \"CompoSR error response\",\n\t\"properties\": {\n\t\t\"httpStatus\": {\n\t\t\t\"type\": \"number\",\n\t\t\t\"descrption\": \"HTTP status code\"\n\t\t},\n\t\t\"error\": {\n\t\t\t\"type\": \"string\",\n\t\t\t\"descrption\": \"error code\"\n\t\t},\n\t\t\"errorDescription\": {\n\t\t\t\"type\": \"string\",\n\t\t\t\"descrption\": \"Public description\"\n\t\t},\n\t\t\"trace\": {\n\t\t\t\"type\": \"string\",\n\t\t\t\"descrption\": \"Development info description\"\n\t\t}\n\t},\n\t\"required\": [\"httpStatus\", \"error\", \"errorDescription\"]\n}",
              "example": "{\n\t\"httpStatus\": 400,\n\t\"error\": \"error:jwt:missing\",\n\t\"errorDescription\": \"Your JWT is missing\"\n}"
            }
          }
        },
        "401": {
          "description": "Not authorized",
          "body": {
            "application/json": {
              "schema": "{\n\t\"$schema\": \"http://json-schema.org/schema\",\n\t\"type\": \"object\",\n\t\"description\": \"CompoSR error response\",\n\t\"properties\": {\n\t\t\"httpStatus\": {\n\t\t\t\"type\": \"number\",\n\t\t\t\"descrption\": \"HTTP status code\"\n\t\t},\n\t\t\"error\": {\n\t\t\t\"type\": \"string\",\n\t\t\t\"descrption\": \"error code\"\n\t\t},\n\t\t\"errorDescription\": {\n\t\t\t\"type\": \"string\",\n\t\t\t\"descrption\": \"Public description\"\n\t\t},\n\t\t\"trace\": {\n\t\t\t\"type\": \"string\",\n\t\t\t\"descrption\": \"Development info description\"\n\t\t}\n\t},\n\t\"required\": [\"httpStatus\", \"error\", \"errorDescription\"]\n}",
              "example": "{\n\t\"httpStatus\": 401,\n\t\"error\": \"unauthorized\",\n\t\"errorDescription\": \"\"\n}"
            }
          }
        }
      },
      "securedBy": [
        "oauth_2_0"
      ]
    }
  }
}